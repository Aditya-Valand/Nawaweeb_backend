{
  "permissions": {
    "allow": [
      "Bash(git add:*)",
      "Bash(\"/c/Users/bhati/OneDrive/Desktop/nawaweeb backend/.claude/worktrees/goofy-sanderson/src/controllers/orderController.js\" <<'EOF'\nconst { supabase } = require\\('../config/db'\\);\n\nconst createOrder = async \\(req, res\\) => {\n  try {\n    const userId = req.user.id;\n    const { items, shipping_address } = req.body;\n\n    if \\(!items || !Array.isArray\\(items\\) || items.length === 0\\) {\n      return res.status\\(400\\).json\\({ success: false, message: 'Order items are required' }\\);\n    }\n\n    const variantIds = items.map\\(item => item.variant_id\\);\n    const { data: variants, error: variantError } = await supabase\n      .from\\('product_variants'\\)\n      .select\\('id, stock_quantity, price_override, product_id, products\\(price, title\\)'\\)\n      .in\\('id', variantIds\\);\n\n    if \\(variantError || variants.length !== variantIds.length\\) {\n      return res.status\\(400\\).json\\({ success: false, message: 'Invalid variants' }\\);\n    }\n\n    const orderItems = [];\n    let totalAmount = 0;\n\n    for \\(const item of items\\) {\n      const variant = variants.find\\(v => v.id === item.variant_id\\);\n      if \\(variant.stock_quantity < item.quantity\\) {\n        return res.status\\(400\\).json\\({ \n          success: false, \n          message: `Insufficient stock for ${variant.products.title}` \n        }\\);\n      }\n      const price = variant.price_override || variant.products.price;\n      orderItems.push\\({ variant_id: variant.id, quantity: item.quantity, price_at_purchase: price }\\);\n      totalAmount += price * item.quantity;\n    }\n\n    const { data: order, error: orderError } = await supabase\n      .from\\('orders'\\)\n      .insert\\({ user_id: userId, total_amount: totalAmount, status: 'pending', payment_status: 'pending', shipping_address }\\)\n      .select\\(\\)\n      .single\\(\\);\n\n    if \\(orderError\\) {\n      return res.status\\(500\\).json\\({ success: false, message: 'Failed to create order' }\\);\n    }\n\n    const orderItemsWithOrderId = orderItems.map\\(item => \\({ ...item, order_id: order.id }\\)\\);\n    const { error: itemsError } = await supabase.from\\('order_items'\\).insert\\(orderItemsWithOrderId\\);\n\n    if \\(itemsError\\) {\n      await supabase.from\\('orders'\\).delete\\(\\).eq\\('id', order.id\\);\n      return res.status\\(500\\).json\\({ success: false, message: 'Failed to create order items' }\\);\n    }\n\n    for \\(const item of items\\) {\n      const variant = variants.find\\(v => v.id === item.variant_id\\);\n      await supabase\n        .from\\('product_variants'\\)\n        .update\\({ stock_quantity: variant.stock_quantity - item.quantity }\\)\n        .eq\\('id', item.variant_id\\);\n    }\n\n    return res.status\\(201\\).json\\({ success: true, message: 'Order created successfully', data: { order } }\\);\n  } catch \\(error\\) {\n    console.error\\('Create order error:', error\\);\n    return res.status\\(500\\).json\\({ success: false, message: 'Internal server error' }\\);\n  }\n};\n\nconst getUserOrders = async \\(req, res\\) => {\n  try {\n    const { data: orders, error } = await supabase\n      .from\\('orders'\\)\n      .select\\('*, order_items\\(*, product_variants\\(size, products\\(title, images\\)\\)\\)'\\)\n      .eq\\('user_id', req.user.id\\)\n      .order\\('created_at', { ascending: false }\\);\n\n    if \\(error\\) return res.status\\(400\\).json\\({ success: false, message: error.message }\\);\n    return res.status\\(200\\).json\\({ success: true, count: orders.length, data: { orders } }\\);\n  } catch \\(error\\) {\n    return res.status\\(500\\).json\\({ success: false, message: 'Internal server error' }\\);\n  }\n};\n\nconst getOrderById = async \\(req, res\\) => {\n  try {\n    const { id } = req.params;\n    let query = supabase\n      .from\\('orders'\\)\n      .select\\('*, profiles!orders_user_id_fkey\\(full_name, email\\), order_items\\(*, product_variants\\(size, products\\(title, images\\)\\)\\)'\\)\n      .eq\\('id', id\\);\n\n    if \\(req.user.role !== 'admin'\\) query = query.eq\\('user_id', req.user.id\\);\n\n    const { data: order, error } = await query.single\\(\\);\n\n    if \\(error\\) {\n      if \\(error.code === 'PGRST116'\\) return res.status\\(404\\).json\\({ success: false, message: 'Order not found' }\\);\n      return res.status\\(400\\).json\\({ success: false, message: error.message }\\);\n    }\n\n    return res.status\\(200\\).json\\({ success: true, data: { order } }\\);\n  } catch \\(error\\) {\n    return res.status\\(500\\).json\\({ success: false, message: 'Internal server error' }\\);\n  }\n};\n\nconst getAllOrders = async \\(req, res\\) => {\n  try {\n    if \\(req.user.role !== 'admin'\\) {\n      return res.status\\(403\\).json\\({ success: false, message: 'Access denied. Admin only.' }\\);\n    }\n\n    const { status, limit = 50, offset = 0 } = req.query;\n    let query = supabase\n      .from\\('orders'\\)\n      .select\\('*, profiles!orders_user_id_fkey\\(full_name, email\\), order_items\\(quantity, price_at_purchase\\)', { count: 'exact' }\\)\n      .order\\('created_at', { ascending: false }\\)\n      .range\\(offset, offset + limit - 1\\);\n\n    if \\(status\\) query = query.eq\\('status', status\\);\n\n    const { data: orders, error, count } = await query;\n\n    if \\(error\\) return res.status\\(400\\).json\\({ success: false, message: error.message }\\);\n    return res.status\\(200\\).json\\({ success: true, count, data: { orders } }\\);\n  } catch \\(error\\) {\n    return res.status\\(500\\).json\\({ success: false, message: 'Internal server error' }\\);\n  }\n};\n\nconst updateOrderStatus = async \\(req, res\\) => {\n  try {\n    if \\(req.user.role !== 'admin'\\) {\n      return res.status\\(403\\).json\\({ success: false, message: 'Access denied. Admin only.' }\\);\n    }\n\n    const { id } = req.params;\n    const { status, payment_status } = req.body;\n    const updates = {};\n\n    const validStatuses = ['pending', 'processing', 'shipped', 'delivered', 'cancelled'];\n    const validPaymentStatuses = ['pending', 'paid', 'failed', 'refunded'];\n\n    if \\(status && validStatuses.includes\\(status\\)\\) updates.status = status;\n    if \\(payment_status && validPaymentStatuses.includes\\(payment_status\\)\\) updates.payment_status = payment_status;\n\n    if \\(Object.keys\\(updates\\).length === 0\\) {\n      return res.status\\(400\\).json\\({ success: false, message: 'No valid fields to update' }\\);\n    }\n\n    const { data: order, error } = await supabase\n      .from\\('orders'\\)\n      .update\\(updates\\)\n      .eq\\('id', id\\)\n      .select\\(\\)\n      .single\\(\\);\n\n    if \\(error\\) {\n      if \\(error.code === 'PGRST116'\\) return res.status\\(404\\).json\\({ success: false, message: 'Order not found' }\\);\n      return res.status\\(400\\).json\\({ success: false, message: error.message }\\);\n    }\n\n    return res.status\\(200\\).json\\({ success: true, message: 'Order updated successfully', data: { order } }\\);\n  } catch \\(error\\) {\n    return res.status\\(500\\).json\\({ success: false, message: 'Internal server error' }\\);\n  }\n};\n\nconst cancelOrder = async \\(req, res\\) => {\n  try {\n    const { id } = req.params;\n    const { data: order, error: fetchError } = await supabase\n      .from\\('orders'\\)\n      .select\\('*, order_items\\(variant_id, quantity\\)'\\)\n      .eq\\('id', id\\)\n      .single\\(\\);\n\n    if \\(fetchError || !order\\) {\n      return res.status\\(404\\).json\\({ success: false, message: 'Order not found' }\\);\n    }\n\n    if \\(req.user.role !== 'admin' && order.user_id !== req.user.id\\) {\n      return res.status\\(403\\).json\\({ success: false, message: 'Access denied' }\\);\n    }\n\n    if \\(order.status !== 'pending'\\) {\n      return res.status\\(400\\).json\\({ success: false, message: 'Only pending orders can be cancelled' }\\);\n    }\n\n    const { error: updateError } = await supabase.from\\('orders'\\).update\\({ status: 'cancelled' }\\).eq\\('id', id\\);\n\n    if \\(updateError\\) return res.status\\(500\\).json\\({ success: false, message: 'Failed to cancel order' }\\);\n\n    for \\(const item of order.order_items\\) {\n      const { data: variant } = await supabase\n        .from\\('product_variants'\\)\n        .select\\('stock_quantity'\\)\n        .eq\\('id', item.variant_id\\)\n        .single\\(\\);\n\n      if \\(variant\\) {\n        await supabase\n          .from\\('product_variants'\\)\n          .update\\({ stock_quantity: variant.stock_quantity + item.quantity }\\)\n          .eq\\('id', item.variant_id\\);\n      }\n    }\n\n    return res.status\\(200\\).json\\({ success: true, message: 'Order cancelled successfully' }\\);\n  } catch \\(error\\) {\n    return res.status\\(500\\).json\\({ success: false, message: 'Internal server error' }\\);\n  }\n};\n\nmodule.exports = { createOrder, getUserOrders, getOrderById, getAllOrders, updateOrderStatus, cancelOrder };\nEOF)",
      "Bash(git commit:*)",
      "Bash(git push:*)",
      "Bash(\"/c/Users/bhati/OneDrive/Desktop/nawaweeb backend/.claude/worktrees/goofy-sanderson/API_DOCUMENTATION.md\" << 'EOF'\n# üöÄ Nawaweeb Backend API Documentation\n\n## Base URL\n```\nhttp://localhost:5000/api\n```\n\n---\n\n## üîê Authentication Endpoints\n\n### 1. Register User\n**POST** `/auth/register`\n\n**Request Body:**\n```json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\",\n  \"full_name\": \"John Doe\"\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"User registered successfully\",\n  \"data\": {\n    \"user\": {\n      \"id\": \"uuid\",\n      \"email\": \"user@example.com\",\n      \"full_name\": \"John Doe\"\n    }\n  }\n}\n```\n\n---\n\n### 2. Login User\n**POST** `/auth/login`\n\n**Request Body:**\n```json\n{\n  \"email\": \"user@example.com\",\n  \"password\": \"securePassword123\"\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Login successful\",\n  \"data\": {\n    \"token\": \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\",\n    \"refresh_token\": \"refresh_token_here\",\n    \"user\": {\n      \"id\": \"uuid\",\n      \"email\": \"user@example.com\",\n      \"full_name\": \"John Doe\",\n      \"role\": \"customer\",\n      \"is_clan_member\": false\n    }\n  }\n}\n```\n\n---\n\n### 3. Get Profile \\(Protected\\)\n**GET** `/auth/profile`\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"user\": {\n      \"id\": \"uuid\",\n      \"email\": \"user@example.com\",\n      \"full_name\": \"John Doe\",\n      \"role\": \"customer\",\n      \"is_clan_member\": false\n    }\n  }\n}\n```\n\n---\n\n### 4. Update Profile \\(Protected\\)\n**PATCH** `/auth/profile`\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Request Body:**\n```json\n{\n  \"full_name\": \"John Updated\",\n  \"is_clan_member\": true\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Profile updated successfully\",\n  \"data\": {\n    \"user\": {\n      \"id\": \"uuid\",\n      \"email\": \"user@example.com\",\n      \"full_name\": \"John Updated\",\n      \"role\": \"customer\",\n      \"is_clan_member\": true\n    }\n  }\n}\n```\n\n---\n\n### 5. Update User Role \\(Admin Only\\)\n**PATCH** `/auth/users/role`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Request Body:**\n```json\n{\n  \"userId\": \"user_uuid\",\n  \"role\": \"admin\"\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"User role updated successfully\",\n  \"data\": {\n    \"user\": {\n      \"id\": \"uuid\",\n      \"role\": \"admin\"\n    }\n  }\n}\n```\n\n---\n\n## üõçÔ∏è Product Endpoints\n\n### 1. Get All Products \\(Public\\)\n**GET** `/products`\n\n**Query Parameters:**\n- `active` \\(optional\\): \"true\" or \"false\" - Filter by active status\n- `search` \\(optional\\): Search by product title\n\n**Example:**\n```\nGET /products?active=true&search=naruto\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"count\": 2,\n  \"data\": {\n    \"products\": [\n      {\n        \"id\": \"uuid\",\n        \"title\": \"Naruto Hoodie\",\n        \"slug\": \"naruto-hoodie\",\n        \"price\": 4999,\n        \"images\": [\"https://cloudinary.com/image1.jpg\"],\n        \"description\": \"Premium quality hoodie\",\n        \"is_active\": true,\n        \"product_variants\": [\n          {\n            \"id\": \"uuid\",\n            \"size\": \"M\",\n            \"stock_quantity\": 10,\n            \"price_override\": null\n          },\n          {\n            \"id\": \"uuid\",\n            \"size\": \"L\",\n            \"stock_quantity\": 5,\n            \"price_override\": 5499\n          }\n        ],\n        \"total_stock\": 15\n      }\n    ]\n  }\n}\n```\n\n---\n\n### 2. Get Product by ID or Slug \\(Public\\)\n**GET** `/products/:id`\n\n**Example:**\n```\nGET /products/naruto-hoodie\nGET /products/uuid-here\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"product\": {\n      \"id\": \"uuid\",\n      \"title\": \"Naruto Hoodie\",\n      \"slug\": \"naruto-hoodie\",\n      \"price\": 4999,\n      \"images\": [\"https://cloudinary.com/image1.jpg\"],\n      \"description\": \"Premium quality hoodie\",\n      \"is_active\": true,\n      \"product_variants\": [\n        {\n          \"id\": \"uuid\",\n          \"size\": \"M\",\n          \"stock_quantity\": 10,\n          \"price_override\": null\n        }\n      ]\n    }\n  }\n}\n```\n\n---\n\n### 3. Create Product \\(Admin Only\\)\n**POST** `/products`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Request Body:**\n```json\n{\n  \"title\": \"Naruto Hoodie\",\n  \"slug\": \"naruto-hoodie\",\n  \"price\": 4999,\n  \"images\": [\"https://cloudinary.com/image1.jpg\", \"https://cloudinary.com/image2.jpg\"],\n  \"description\": \"Premium quality Naruto themed hoodie\",\n  \"is_active\": true,\n  \"variants\": [\n    {\n      \"size\": \"S\",\n      \"stock_quantity\": 10,\n      \"price_override\": null\n    },\n    {\n      \"size\": \"M\",\n      \"stock_quantity\": 15,\n      \"price_override\": null\n    },\n    {\n      \"size\": \"L\",\n      \"stock_quantity\": 8,\n      \"price_override\": 5499\n    }\n  ]\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Product created successfully\",\n  \"data\": {\n    \"product\": {\n      \"id\": \"uuid\",\n      \"title\": \"Naruto Hoodie\",\n      \"product_variants\": [...]\n    }\n  }\n}\n```\n\n---\n\n### 4. Update Product \\(Admin Only\\)\n**PATCH** `/products/:id`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Request Body:**\n```json\n{\n  \"title\": \"Updated Naruto Hoodie\",\n  \"price\": 5499,\n  \"is_active\": false\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Product updated successfully\",\n  \"data\": {\n    \"product\": {\n      \"id\": \"uuid\",\n      \"title\": \"Updated Naruto Hoodie\",\n      \"price\": 5499\n    }\n  }\n}\n```\n\n---\n\n### 5. Delete Product \\(Admin Only\\)\n**DELETE** `/products/:id`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Product deleted successfully\"\n}\n```\n\n---\n\n### 6. Add Variant to Product \\(Admin Only\\)\n**POST** `/products/:productId/variants`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Request Body:**\n```json\n{\n  \"size\": \"XL\",\n  \"stock_quantity\": 20,\n  \"price_override\": 5999\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Variant added successfully\",\n  \"data\": {\n    \"variant\": {\n      \"id\": \"uuid\",\n      \"product_id\": \"product_uuid\",\n      \"size\": \"XL\",\n      \"stock_quantity\": 20,\n      \"price_override\": 5999\n    }\n  }\n}\n```\n\n---\n\n### 7. Update Variant Stock \\(Admin Only\\)\n**PATCH** `/products/variants/:variantId/stock`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Request Body:**\n```json\n{\n  \"stock_quantity\": 50\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Variant stock updated successfully\",\n  \"data\": {\n    \"variant\": {\n      \"id\": \"uuid\",\n      \"stock_quantity\": 50\n    }\n  }\n}\n```\n\n---\n\n## üì¶ Order Endpoints\n\n### 1. Create Order \\(Protected\\)\n**POST** `/orders`\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Request Body:**\n```json\n{\n  \"items\": [\n    {\n      \"variant_id\": \"variant_uuid_1\",\n      \"quantity\": 2\n    },\n    {\n      \"variant_id\": \"variant_uuid_2\",\n      \"quantity\": 1\n    }\n  ],\n  \"shipping_address\": {\n    \"address\": \"123 Main Street\",\n    \"city\": \"Mumbai\",\n    \"state\": \"Maharashtra\",\n    \"pincode\": \"400001\",\n    \"phone\": \"+919876543210\"\n  }\n}\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Order created successfully\",\n  \"data\": {\n    \"order\": {\n      \"id\": \"uuid\",\n      \"user_id\": \"user_uuid\",\n      \"total_amount\": 14997,\n      \"status\": \"pending\",\n      \"payment_status\": \"pending\",\n      \"shipping_address\": {...},\n      \"order_items\": [\n        {\n          \"id\": \"uuid\",\n          \"variant_id\": \"variant_uuid\",\n          \"quantity\": 2,\n          \"price_at_purchase\": 4999,\n          \"product_variants\": {\n            \"size\": \"M\",\n            \"products\": {\n              \"title\": \"Naruto Hoodie\",\n              \"images\": [\"url\"]\n            }\n          }\n        }\n      ]\n    }\n  }\n}\n```\n\n---\n\n### 2. Get User Orders \\(Protected\\)\n**GET** `/orders`\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Query Parameters:**\n- `status` \\(optional\\): Filter by order status \\(pending, processing, shipped, delivered, cancelled\\)\n\n**Example:**\n```\nGET /orders?status=pending\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"count\": 3,\n  \"data\": {\n    \"orders\": [\n      {\n        \"id\": \"uuid\",\n        \"total_amount\": 14997,\n        \"status\": \"pending\",\n        \"payment_status\": \"pending\",\n        \"created_at\": \"2024-02-14T10:30:00Z\",\n        \"order_items\": [...]\n      }\n    ]\n  }\n}\n```\n\n---\n\n### 3. Get Order by ID \\(Protected\\)\n**GET** `/orders/:id`\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"data\": {\n    \"order\": {\n      \"id\": \"uuid\",\n      \"user_id\": \"user_uuid\",\n      \"total_amount\": 14997,\n      \"status\": \"pending\",\n      \"payment_status\": \"pending\",\n      \"shipping_address\": {...},\n      \"profiles\": {\n        \"full_name\": \"John Doe\",\n        \"email\": \"user@example.com\"\n      },\n      \"order_items\": [...]\n    }\n  }\n}\n```\n\n---\n\n### 4. Cancel Order \\(Protected\\)\n**POST** `/orders/:id/cancel`\n\n**Headers:**\n```\nAuthorization: Bearer <token>\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Order cancelled successfully\"\n}\n```\n\n**Note:** Only pending orders can be cancelled. Stock is automatically restored.\n\n---\n\n### 5. Get All Orders \\(Admin Only\\)\n**GET** `/orders/admin/all`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Query Parameters:**\n- `status` \\(optional\\): Filter by status\n- `payment_status` \\(optional\\): Filter by payment status\n- `limit` \\(optional, default: 50\\): Number of orders per page\n- `offset` \\(optional, default: 0\\): Pagination offset\n\n**Example:**\n```\nGET /orders/admin/all?status=pending&limit=20&offset=0\n```\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"count\": 150,\n  \"data\": {\n    \"orders\": [\n      {\n        \"id\": \"uuid\",\n        \"total_amount\": 14997,\n        \"status\": \"pending\",\n        \"payment_status\": \"pending\",\n        \"profiles\": {\n          \"full_name\": \"John Doe\",\n          \"email\": \"user@example.com\"\n        },\n        \"order_items\": [\n          {\n            \"quantity\": 2,\n            \"price_at_purchase\": 4999\n          }\n        ]\n      }\n    ]\n  }\n}\n```\n\n---\n\n### 6. Update Order Status \\(Admin Only\\)\n**PATCH** `/orders/:id/status`\n\n**Headers:**\n```\nAuthorization: Bearer <admin_token>\n```\n\n**Request Body:**\n```json\n{\n  \"status\": \"shipped\",\n  \"payment_status\": \"paid\"\n}\n```\n\n**Valid Status Values:**\n- `pending`\n- `processing`\n- `shipped`\n- `delivered`\n- `cancelled`\n\n**Valid Payment Status Values:**\n- `pending`\n- `paid`\n- `failed`\n- `refunded`\n\n**Response:**\n```json\n{\n  \"success\": true,\n  \"message\": \"Order updated successfully\",\n  \"data\": {\n    \"order\": {\n      \"id\": \"uuid\",\n      \"status\": \"shipped\",\n      \"payment_status\": \"paid\"\n    }\n  }\n}\n```\n\n---\n\n## üîí Authentication\n\nAll protected routes require a Bearer token in the Authorization header:\n\n```\nAuthorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...\n```\n\n### User Roles:\n- **customer**: Can create orders, view own orders, update own profile\n- **admin**: All customer permissions + product management + order management\n\n---\n\n## ‚ö†Ô∏è Error Responses\n\nAll errors follow this format:\n\n```json\n{\n  \"success\": false,\n  \"message\": \"Error description here\"\n}\n```\n\n### Common Error Codes:\n- `400` - Bad Request \\(validation errors\\)\n- `401` - Unauthorized \\(missing or invalid token\\)\n- `403` - Forbidden \\(insufficient permissions\\)\n- `404` - Not Found \\(resource doesn't exist\\)\n- `500` - Internal Server Error\n\n---\n\n## üí° Notes\n\n1. **Price Format**: All prices are in **cents** \\(e.g., 4999 = ‚Çπ49.99\\)\n2. **Stock Management**: Stock is automatically decremented on order creation and restored on cancellation\n3. **Pagination**: Use `limit` and `offset` query parameters for paginating large result sets\n4. **Filtering**: Most GET endpoints support query parameters for filtering\n5. **Nested Data**: Orders include nested product and variant information for easy display\n\n---\n\n## üõ†Ô∏è Testing with cURL\n\n### Register:\n```bash\ncurl -X POST http://localhost:5000/api/auth/register \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\"email\":\"test@example.com\",\"password\":\"password123\",\"full_name\":\"Test User\"}'\n```\n\n### Login:\n```bash\ncurl -X POST http://localhost:5000/api/auth/login \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -d '{\"email\":\"test@example.com\",\"password\":\"password123\"}'\n```\n\n### Get Products:\n```bash\ncurl http://localhost:5000/api/products\n```\n\n### Create Order:\n```bash\ncurl -X POST http://localhost:5000/api/orders \\\\\n  -H \"Content-Type: application/json\" \\\\\n  -H \"Authorization: Bearer YOUR_TOKEN\" \\\\\n  -d '{\"items\":[{\"variant_id\":\"variant_uuid\",\"quantity\":1}],\"shipping_address\":{\"address\":\"123 St\",\"city\":\"Mumbai\",\"state\":\"MH\",\"pincode\":\"400001\",\"phone\":\"9876543210\"}}'\n```\n\n---\n\n**Generated for Nawaweeb Backend v2.0.0**  \n**Database:** Supabase PostgreSQL  \n**Last Updated:** February 2024\nEOF)",
      "Bash(git reset:*)",
      "Bash(git pull:*)"
    ]
  }
}
